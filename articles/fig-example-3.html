<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Illustration 3 - Regions of Significance ‚Ä¢ manCTMed</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Illustration 3 - Regions of Significance">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">manCTMed</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/manCTMed.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/jeksterslab/manCTMed/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Illustration 3 - Regions of Significance</h1>
                        <h4 data-toc-skip class="author">Ivan Jacob
Agaloos Pesigan</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jeksterslab/manCTMed/blob/main/vignettes/fig-example-3.Rmd"><code>vignettes/fig-example-3.Rmd</code></a></small>
      <div class="d-none name"><code>fig-example-3.Rmd</code></div>
    </div>

    
    
<p>This vignette accompanies Illustration 3. The goal of the
illustration is to visualize regions of significance, that is, a range
of time intervals, where the effects are significantly different from
zero, using confidence intervals for the direct, indirect, and total
effects from the continuous-time vector autoregressive model drift
matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùöΩ</mi><annotation encoding="application/x-tex">\boldsymbol{\Phi}</annotation></semantics></math>
and process noise covariance matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùö∫</mi><annotation encoding="application/x-tex">\boldsymbol{\Sigma}</annotation></semantics></math>
for a range of time intervals. This example features <code>plot</code>
methods for the <code>DeltaMed</code>, <code>MCMed</code>,
<code>BootMed</code>, <code>DeltaMedStd</code>, <code>MCMedStd</code>,
and <code>BootMedStd</code> functions from the <code>cTMed</code>
package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jeksterslab/bootStateSpace" class="external-link">bootStateSpace</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jeksterslab/cTMed" class="external-link">cTMed</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="continuous-time-vector-autoregressive-model-estimates">Continuous-Time Vector Autoregressive Model Estimates<a class="anchor" aria-label="anchor" href="#continuous-time-vector-autoregressive-model-estimates"></a>
</h2>
<p>The object <code>fit</code> contains the fitted <code>dynr</code>
model. Data is generated using the
<code><a href="../reference/IllustrationGenData.html">manCTMed::IllustrationGenData</a></code> function. The model was
fitted using the <code><a href="../reference/IllustrationFitDynr.html">manCTMed::IllustrationFitDynr</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value   ci.lower   ci.upper Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; phi_11    -0.1157754  0.0174197  -6.646 -0.1499173 -0.0816334   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; phi_12     0.0203747  0.0550571   0.370 -0.0875352  0.1282846   0.3557    </span></span>
<span><span class="co">#&gt; phi_13    -0.0070992  0.0535302  -0.133 -0.1120165  0.0978181   0.4472    </span></span>
<span><span class="co">#&gt; phi_21    -0.1226909  0.0187426  -6.546 -0.1594258 -0.0859560   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; phi_22    -0.8819998  0.0653717 -13.492 -1.0101259 -0.7538737   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; phi_23     0.4737224  0.0594135   7.973  0.3572740  0.5901708   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; phi_31    -0.0877980  0.0178492  -4.919 -0.1227817 -0.0528143   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; phi_32     0.0595814  0.0586861   1.015 -0.0554414  0.1746041   0.1550    </span></span>
<span><span class="co">#&gt; phi_33    -0.6636176  0.0616495 -10.764 -0.7844485 -0.5427867   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; sigma_11   0.0954899  0.0049239  19.393  0.0858393  0.1051405   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; sigma_12   0.0009624  0.0040987   0.235 -0.0070710  0.0089957   0.4072    </span></span>
<span><span class="co">#&gt; sigma_13   0.0070297  0.0040069   1.754 -0.0008237  0.0148830   0.0397 *  </span></span>
<span><span class="co">#&gt; sigma_22   0.1027182  0.0078961  13.009  0.0872422  0.1181942   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; sigma_23   0.0009240  0.0049248   0.188 -0.0087285  0.0105764   0.4256    </span></span>
<span><span class="co">#&gt; sigma_33   0.0991956  0.0074695  13.280  0.0845558  0.1138355   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; theta_11   0.1016133  0.0014901  68.194  0.0986928  0.1045338   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; theta_22   0.0996380  0.0015668  63.592  0.0965671  0.1027089   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; theta_33   0.0992561  0.0015460  64.202  0.0962260  0.1022862   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; mu0_1     -0.1217526  0.0521444  -2.335 -0.2239538 -0.0195514   0.0098 ** </span></span>
<span><span class="co">#&gt; mu0_2      0.0160785  0.0279075   0.576 -0.0386192  0.0707762   0.2823    </span></span>
<span><span class="co">#&gt; mu0_3      0.0204163  0.0288928   0.707 -0.0362125  0.0770451   0.2399    </span></span>
<span><span class="co">#&gt; sigma0_11  0.3346315  0.0446548   7.494  0.2471097  0.4221533   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; sigma0_12 -0.0644525  0.0177503  -3.631 -0.0992424 -0.0296626   0.0001 ***</span></span>
<span><span class="co">#&gt; sigma0_13 -0.0519690  0.0179974  -2.888 -0.0872433 -0.0166946   0.0019 ** </span></span>
<span><span class="co">#&gt; sigma0_22  0.0691741  0.0127707   5.417  0.0441439  0.0942043   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; sigma0_23  0.0364469  0.0098132   3.714  0.0172134  0.0556805   0.0001 ***</span></span>
<span><span class="co">#&gt; sigma0_33  0.0792446  0.0137057   5.782  0.0523819  0.1061072   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -2 log-likelihood value at convergence = 32662.46</span></span>
<span><span class="co">#&gt; AIC = 32716.46</span></span>
<span><span class="co">#&gt; BIC = 32919.11</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="parameter-estimates">Parameter Estimates<a class="anchor" aria-label="anchor" href="#parameter-estimates"></a>
</h2>
<p>We extract parameter estimates from the <code>fit</code> object.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># drift matrix</span></span>
<span><span class="va">phi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"phi_11"</span>, <span class="st">"phi_21"</span>, <span class="st">"phi_31"</span>,</span>
<span>      <span class="st">"phi_12"</span>, <span class="st">"phi_22"</span>, <span class="st">"phi_32"</span>,</span>
<span>      <span class="st">"phi_13"</span>, <span class="st">"phi_23"</span>, <span class="st">"phi_33"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">]</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># column names and row names are needed to define the indirect effects</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">phi</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">phi</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"conflict"</span>,</span>
<span>  <span class="st">"knowledge"</span>,</span>
<span>  <span class="st">"competence"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># process noise covariance matrix</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"sigma_11"</span>, <span class="st">"sigma_12"</span>, <span class="st">"sigma_13"</span>,</span>
<span>      <span class="st">"sigma_12"</span>, <span class="st">"sigma_22"</span>, <span class="st">"sigma_23"</span>,</span>
<span>      <span class="st">"sigma_13"</span>, <span class="st">"sigma_23"</span>, <span class="st">"sigma_33"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">]</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># measurement error covariance matrix</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"theta_11"</span>, <span class="fl">0</span>, <span class="fl">0</span>,</span>
<span>      <span class="fl">0</span>, <span class="st">"theta_22"</span>, <span class="fl">0</span>,</span>
<span>      <span class="fl">0</span>, <span class="fl">0</span>, <span class="st">"theta_33"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">]</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># initial condition</span></span>
<span><span class="va">mu0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"mu0_1"</span>, <span class="st">"mu0_2"</span>, <span class="st">"mu0_3"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">]</span></span>
<span><span class="va">sigma0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"sigma0_11"</span>, <span class="st">"sigma0_12"</span>, <span class="st">"sigma0_13"</span>,</span>
<span>      <span class="st">"sigma0_12"</span>, <span class="st">"sigma0_22"</span>, <span class="st">"sigma0_23"</span>,</span>
<span>      <span class="st">"sigma0_13"</span>, <span class="st">"sigma0_23"</span>, <span class="st">"sigma0_33"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">]</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="sampling-variance-covariance-matrix-of-parameter-estimates">Sampling Variance-Covariance Matrix of Parameter Estimates<a class="anchor" aria-label="anchor" href="#sampling-variance-covariance-matrix-of-parameter-estimates"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># combining the drift matrix and the process noise covariance matrix</span></span>
<span><span class="va">phi_sigma_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"phi_11"</span>, <span class="st">"phi_21"</span>, <span class="st">"phi_31"</span>,</span>
<span>  <span class="st">"phi_12"</span>, <span class="st">"phi_22"</span>, <span class="st">"phi_32"</span>,</span>
<span>  <span class="st">"phi_13"</span>, <span class="st">"phi_23"</span>, <span class="st">"phi_33"</span>,</span>
<span>  <span class="st">"sigma_11"</span>, <span class="st">"sigma_12"</span>, <span class="st">"sigma_13"</span>,</span>
<span>  <span class="st">"sigma_22"</span>, <span class="st">"sigma_23"</span>,</span>
<span>  <span class="st">"sigma_33"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">vcov_theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span><span class="va">phi_sigma_names</span>, <span class="va">phi_sigma_names</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phi_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"phi_11"</span>, <span class="st">"phi_21"</span>, <span class="st">"phi_31"</span>,</span>
<span>  <span class="st">"phi_12"</span>, <span class="st">"phi_22"</span>, <span class="st">"phi_32"</span>,</span>
<span>  <span class="st">"phi_13"</span>, <span class="st">"phi_23"</span>, <span class="st">"phi_33"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">vcov_phi_vec</span> <span class="op">&lt;-</span> <span class="va">vcov_theta</span><span class="op">[</span><span class="va">phi_names</span>, <span class="va">phi_names</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># range of time intervals</span></span>
<span><span class="va">delta_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">0</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">10</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="delta-method-confidence-intervals-for-the-direct-indirect-and-total-effects">Delta Method Confidence Intervals For The Direct, Indirect, and
Total Effects<a class="anchor" aria-label="anchor" href="#delta-method-confidence-intervals-for-the-direct-indirect-and-total-effects"></a>
</h2>
<p>Using the <code>DeltaMed</code> function from the <code>cTMed</code>
package, confidence intervals for the direct, indirect, and total
effects for a long sequence of time interval values are generated. This
makes regions of significance more visible. Consider using the
<code>ncores</code> argument to use multiple cores when the
<code>delta_t</code> vector is long. The <code>plot</code> method for
the <code>DeltaMed</code> presents the regions of significance visually
represented by shaded areas in the plot.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://github.com/jeksterslab/cTMed/reference/DeltaMed.html" class="external-link">DeltaMed</a></span><span class="op">(</span></span>
<span>  phi <span class="op">=</span> <span class="va">phi</span>,</span>
<span>  vcov_phi_vec <span class="op">=</span> <span class="va">vcov_phi_vec</span>,</span>
<span>  delta_t <span class="op">=</span> <span class="va">delta_t</span>,</span>
<span>  from <span class="op">=</span> <span class="st">"conflict"</span>,</span>
<span>  to <span class="op">=</span> <span class="st">"competence"</span>,</span>
<span>  med <span class="op">=</span> <span class="st">"knowledge"</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">delta</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig-vignettes-example-3-unnamed-chunk-14-1.png" width="1700"><img src="fig-vignettes-example-3-unnamed-chunk-14-2.png" width="1700"><img src="fig-vignettes-example-3-unnamed-chunk-14-3.png" width="1700"></p>
</div>
<div class="section level2">
<h2 id="monte-carlo-method-confidence-intervals-for-the-direct-indirect-and-total-effects">Monte Carlo Method Confidence Intervals For The Direct, Indirect,
and Total Effects<a class="anchor" aria-label="anchor" href="#monte-carlo-method-confidence-intervals-for-the-direct-indirect-and-total-effects"></a>
</h2>
<p>Using the <code>MCMed</code> function from the <code>cTMed</code>
package, confidence intervals for the direct, indirect, and total
effects for a long sequence of time interval values are generated. This
makes regions of significance more visible. Consider using the
<code>ncores</code> argument to use multiple cores when the
<code>delta_t</code> vector is long. The <code>plot</code> method for
the <code>MCMed</code> presents the regions of significance visually
represented by shaded areas in the plot.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://github.com/jeksterslab/cTMed/reference/MCMed.html" class="external-link">MCMed</a></span><span class="op">(</span></span>
<span>  phi <span class="op">=</span> <span class="va">phi</span>,</span>
<span>  vcov_phi_vec <span class="op">=</span> <span class="va">vcov_phi_vec</span>,</span>
<span>  delta_t <span class="op">=</span> <span class="va">delta_t</span>,</span>
<span>  from <span class="op">=</span> <span class="st">"conflict"</span>,</span>
<span>  to <span class="op">=</span> <span class="st">"competence"</span>,</span>
<span>  med <span class="op">=</span> <span class="st">"knowledge"</span>,</span>
<span>  R <span class="op">=</span> <span class="fl">20000L</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span>, <span class="co"># use multiple cores</span></span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mc</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig-vignettes-example-3-unnamed-chunk-15-1.png" width="1700"><img src="fig-vignettes-example-3-unnamed-chunk-15-2.png" width="1700"><img src="fig-vignettes-example-3-unnamed-chunk-15-3.png" width="1700"></p>
</div>
<div class="section level2">
<h2 id="parametric-bootstrap-method-confidence-intervals-for-the-direct-indirect-and-total-effects">Parametric Bootstrap Method Confidence Intervals For The Direct,
Indirect, and Total Effects<a class="anchor" aria-label="anchor" href="#parametric-bootstrap-method-confidence-intervals-for-the-direct-indirect-and-total-effects"></a>
</h2>
<p>The parametric bootstrap approach involves generating data from the
parametric model and fitting the model on the generated data multiple
times. The data generation and model fitting is hadled by the
<code>bootStateSpace</code> package. The estimated parameters are passed
as arguments to the <code>PBSSMOUFixed</code> function from the
<code>bootStateSpace</code> package, which generates a parametric
bootstrap sampling distribution of the parameter estimates. The argument
<code>R</code> specifies the number of bootstrap replications. The
generated data and model estimates are be stored in <code>path</code>
using the specified <code>prefix</code> for the file names. The
<code>ncores = parallel::detectCores()</code> argument instructs the
function to use all available CPU cores in the system.</p>
<blockquote>
<p><strong><em>NOTE:</em></strong> Fitting the CT-VAR model multiple
times is computationally intensive.</p>
</blockquote>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fl">1000L</span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span> <span class="va">root</span><span class="op">$</span><span class="fu">find_file</span><span class="op">(</span></span>
<span>  <span class="st">".setup"</span>,</span>
<span>  <span class="st">"data-raw"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">prefix</span> <span class="op">&lt;-</span> <span class="st">"illustration_pb"</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phi_hat</span> <span class="op">&lt;-</span> <span class="va">phi</span></span>
<span><span class="va">sigma_hat</span> <span class="op">&lt;-</span> <span class="va">sigma</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://github.com/jeksterslab/bootStateSpace/reference/PBSSMOUFixed.html" class="external-link">PBSSMOUFixed</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="va">R</span>,</span>
<span>  path <span class="op">=</span> <span class="va">path</span>,</span>
<span>  prefix <span class="op">=</span> <span class="va">prefix</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">133</span>,</span>
<span>  time <span class="op">=</span> <span class="fl">101</span>,</span>
<span>  delta_t <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>  mu0 <span class="op">=</span> <span class="va">mu0</span>,</span>
<span>  sigma0_l <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chol.html" class="external-link">chol</a></span><span class="op">(</span><span class="va">sigma0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  phi <span class="op">=</span> <span class="va">phi</span>,</span>
<span>  sigma_l <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chol.html" class="external-link">chol</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  nu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/dynr/man/diag-character-method.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>  theta_l <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chol.html" class="external-link">chol</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  mu0_fixed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sigma0_fixed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span>,</span>
<span>  clean <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Using the <code>BootMed</code> function from the <code>cTMed</code>
package, confidence intervals for the direct, indirect, and total
effects for a long sequence of time interval values are generated. This
makes regions of significance more visible. Consider using the
<code>ncores</code> argument to use multiple cores when the
<code>delta_t</code> vector is long. The <code>plot</code> method for
the <code>BootMed</code> presents the regions of significance visually
represented by shaded areas in the plot.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://github.com/jeksterslab/cTMed/reference/BootMed.html" class="external-link">BootMed</a></span><span class="op">(</span></span>
<span>  phi <span class="op">=</span> <span class="fu"><a href="https://github.com/jeksterslab/bootStateSpace/reference/extract.html" class="external-link">extract</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">boot</span>, what <span class="op">=</span> <span class="st">"phi"</span><span class="op">)</span>, <span class="co"># extracts the bootstrap drift matrices</span></span>
<span>  phi_hat <span class="op">=</span> <span class="va">phi_hat</span>,</span>
<span>  delta_t <span class="op">=</span> <span class="va">delta_t</span>,</span>
<span>  from <span class="op">=</span> <span class="st">"conflict"</span>,</span>
<span>  to <span class="op">=</span> <span class="st">"competence"</span>,</span>
<span>  med <span class="op">=</span> <span class="st">"knowledge"</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pb</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig-vignettes-example-3-unnamed-chunk-20-1.png" width="1700"><img src="fig-vignettes-example-3-unnamed-chunk-20-2.png" width="1700"><img src="fig-vignettes-example-3-unnamed-chunk-20-3.png" width="1700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pb</span>, type <span class="op">=</span> <span class="st">"bc"</span><span class="op">)</span> <span class="co"># bias-corrected</span></span></code></pre></div>
<p><img src="fig-vignettes-example-3-unnamed-chunk-20-4.png" width="1700"><img src="fig-vignettes-example-3-unnamed-chunk-20-5.png" width="1700"><img src="fig-vignettes-example-3-unnamed-chunk-20-6.png" width="1700"></p>
</div>
<div class="section level2">
<h2 id="delta-method-confidence-intervals-for-the-standardized-direct-indirect-and-total-effects">Delta Method Confidence Intervals For The Standardized Direct,
Indirect, and Total Effects<a class="anchor" aria-label="anchor" href="#delta-method-confidence-intervals-for-the-standardized-direct-indirect-and-total-effects"></a>
</h2>
<p>Using the <code>DeltaMedStd</code> function from the
<code>cTMed</code> package, confidence intervals for the direct,
indirect, and total effects for a long sequence of time interval values
are generated.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">delta_std</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://github.com/jeksterslab/cTMed/reference/DeltaMedStd.html" class="external-link">DeltaMedStd</a></span><span class="op">(</span></span>
<span>  phi <span class="op">=</span> <span class="va">phi</span>,</span>
<span>  sigma <span class="op">=</span> <span class="va">sigma</span>,</span>
<span>  vcov_theta <span class="op">=</span> <span class="va">vcov_theta</span>,</span>
<span>  delta_t <span class="op">=</span> <span class="va">delta_t</span>,</span>
<span>  from <span class="op">=</span> <span class="st">"conflict"</span>,</span>
<span>  to <span class="op">=</span> <span class="st">"competence"</span>,</span>
<span>  med <span class="op">=</span> <span class="st">"knowledge"</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">delta_std</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig-vignettes-example-3-unnamed-chunk-21-1.png" width="1700"><img src="fig-vignettes-example-3-unnamed-chunk-21-2.png" width="1700"><img src="fig-vignettes-example-3-unnamed-chunk-21-3.png" width="1700"></p>
</div>
<div class="section level2">
<h2 id="monte-carlo-method-confidence-intervals-for-the-standardized-direct-indirect-and-total-effects">Monte Carlo Method Confidence Intervals For The Standardized Direct,
Indirect, and Total Effects<a class="anchor" aria-label="anchor" href="#monte-carlo-method-confidence-intervals-for-the-standardized-direct-indirect-and-total-effects"></a>
</h2>
<p>Using the <code>MCMedStd</code> function from the <code>cTMed</code>
package, confidence intervals for the standardized direct, indirect, and
total effects for a time interval of one, two, and three are given
below.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mc_std</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://github.com/jeksterslab/cTMed/reference/MCMedStd.html" class="external-link">MCMedStd</a></span><span class="op">(</span></span>
<span>  phi <span class="op">=</span> <span class="va">phi</span>,</span>
<span>  sigma <span class="op">=</span> <span class="va">sigma</span>,</span>
<span>  vcov_theta <span class="op">=</span> <span class="va">vcov_theta</span>,</span>
<span>  delta_t <span class="op">=</span> <span class="va">delta_t</span>,</span>
<span>  from <span class="op">=</span> <span class="st">"conflict"</span>,</span>
<span>  to <span class="op">=</span> <span class="st">"competence"</span>,</span>
<span>  med <span class="op">=</span> <span class="st">"knowledge"</span>,</span>
<span>  R <span class="op">=</span> <span class="fl">20000L</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mc_std</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig-vignettes-example-3-unnamed-chunk-22-1.png" width="1700"><img src="fig-vignettes-example-3-unnamed-chunk-22-2.png" width="1700"><img src="fig-vignettes-example-3-unnamed-chunk-22-3.png" width="1700"></p>
</div>
<div class="section level2">
<h2 id="parametric-bootstrap-method-confidence-intervals-for-the-standardized-direct-indirect-and-total-effects">Parametric Bootstrap Method Confidence Intervals For The
Standardized Direct, Indirect, and Total Effects<a class="anchor" aria-label="anchor" href="#parametric-bootstrap-method-confidence-intervals-for-the-standardized-direct-indirect-and-total-effects"></a>
</h2>
<p>Using the <code>BootMedStd</code> function from the
<code>cTMed</code> package, confidence intervals for the standardized
direct, indirect, and total effects for a time interval of one, two, and
three are given below.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://github.com/jeksterslab/cTMed/reference/BootMedStd.html" class="external-link">BootMedStd</a></span><span class="op">(</span></span>
<span>  phi <span class="op">=</span> <span class="fu"><a href="https://github.com/jeksterslab/bootStateSpace/reference/extract.html" class="external-link">extract</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">boot</span>, what <span class="op">=</span> <span class="st">"phi"</span><span class="op">)</span>, <span class="co"># extracts the bootstrap drift matrices</span></span>
<span>  sigma <span class="op">=</span> <span class="fu"><a href="https://github.com/jeksterslab/bootStateSpace/reference/extract.html" class="external-link">extract</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">boot</span>, what <span class="op">=</span> <span class="st">"sigma"</span><span class="op">)</span>, <span class="co"># extracts the bootstrap process noise covariance matrices</span></span>
<span>  phi_hat <span class="op">=</span> <span class="va">phi_hat</span>,</span>
<span>  sigma_hat <span class="op">=</span> <span class="va">sigma_hat</span>,</span>
<span>  delta_t <span class="op">=</span> <span class="va">delta_t</span>,</span>
<span>  from <span class="op">=</span> <span class="st">"conflict"</span>,</span>
<span>  to <span class="op">=</span> <span class="st">"competence"</span>,</span>
<span>  med <span class="op">=</span> <span class="st">"knowledge"</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pb</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig-vignettes-example-3-unnamed-chunk-23-1.png" width="1700"><img src="fig-vignettes-example-3-unnamed-chunk-23-2.png" width="1700"><img src="fig-vignettes-example-3-unnamed-chunk-23-3.png" width="1700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pb</span>, type <span class="op">=</span> <span class="st">"bc"</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig-vignettes-example-3-unnamed-chunk-23-4.png" width="1700"><img src="fig-vignettes-example-3-unnamed-chunk-23-5.png" width="1700"><img src="fig-vignettes-example-3-unnamed-chunk-23-6.png" width="1700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ivan Jacob Agaloos Pesigan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
